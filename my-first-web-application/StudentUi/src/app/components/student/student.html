<div class="page">
  <!-- FIRST DIV: Add Student Form -->
  <div class="add-student-section">
    <div class="card">
      <h1 class="title">Student Management</h1>

      <div class="form">
        <div class="form-row">
          <h2 class="subtitle">Add Student</h2>

          <div class="form-field">
            <label for="name">Name:</label>
            <input id="name" [value]="newStudent().name" (input)="updateName($any($event.target).value)"
              placeholder="Enter Name" />
          </div>

          <small class="error">{{nameError()}}</small>

          <div class="form-field">
            <label for="age">Age:</label>
            <input id="age" type="number" min="1" step="1" [value]="newStudent().age || ''"
              (input)="updateAge($any($event.target).value)" placeholder="Enter Age" />
          </div>

          <small class="error">{{ageError()}}</small>

          <div class="form-field">
            <label for="email">Email:</label>
            <input id="email" type="email" [value]="newStudent().email" (input)="updateEmail($any($event.target).value)"
              placeholder="Enter Email" />
          </div>

          <small class="error">{{emailError()}}</small>

          <!-- STATE DROPDOWN -->
          <div class="form-field">
            <label for="stateSelect">State:</label>
            <select id="stateSelect" [value]="selectedStateId()" (change)="updateState(+$any($event.target).value || null)">
              <option value="0">Select State</option>
              @for (state of states(); track state.stateId) {
              <option [value]="state.stateId">{{ state.stateName }}</option>
              }
            </select>
          </div>

          <small class="error">{{stateError()}}</small>

        </div>

        <div class="actions">
          <button class="primary" (click)="saveStudent()">
            {{ isEditing() ? 'Update Student' : 'Add Student' }}
          </button>

          @if (isEditing()) {
          <button class="secondary" (click)="resetForm()">Cancel</button>
          }

          <!-- Show Students Button -->
          <button class="show-students-btn" (click)="showStudents()">
            Show Students
          </button>

          <!-- Reset Button -->
          <button class="reset-btn" (click)="resetPage()">
            Reset
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- SECOND DIV: Students Table (conditionally shown) -->
  @if (showStudentsTable()) {
  <div class="students-table-section">
    <div class="table-card">
      <h2 class="table-title">Students List</h2>
      
      <!-- DATA TABLE with light background container -->
      <div class="table-container">
        <table id="studentsTable" class="display" style="width:100%">
          <!-- DataTables will generate everything -->
        </table>
      </div>
    </div>
  </div>
  }
</div>